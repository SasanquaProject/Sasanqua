import {
    VerticalBox,
    HorizontalBox
} from "std-widgets.slint";

import {
    Log,
    Progress,
    Status,
    SingleSeparatorH,
    DoubleSeparatorV,
    FloatingButton
} from "./my-widgets/lib.slint";

import {
    EmptyPage,
    ProjectPage,
    CorePage,
    CopPkgPage,
    ValidatePage,
    PartialReconfPage,
    SynthesisPage,
    FPGAPage
} from "./pages/lib.slint";

export component MainWindow inherits Window {
    property <int> stat;

    title: "Sasanqua IDE";
    preferred-width: 1280px;
    preferred-height: 800px;
    background: skyblue;

    // Progress
    Progress {
        y: 0;
        z: 0;
        height: 30px;
        background: root.background;

        stat: stat;
    }

    // Main View
    VerticalBox {
        z: 1;
        height: parent.height;
        spacing: 0px;
        padding: 0px;

        // Page
        VerticalBox {
            height: parent.height * 80%;
            spacing: 0px;
            padding: 8px;
            padding-top: 30px;

            Rectangle {
                height: parent.height - 38px;

                EmptyPage         { enabled: true; }
                ProjectPage       { enabled: stat == 0; }
                CorePage          { enabled: stat == 1; }
                CopPkgPage        { enabled: stat == 2; }
                ValidatePage      { enabled: stat == 3; }
                PartialReconfPage { enabled: stat == 4; }
                SynthesisPage     { enabled: stat == 5; }
                FPGAPage          { enabled: stat == 6; }
            }
        }

        DoubleSeparatorV {
            separator-color: black;
        }

        // Status View
        HorizontalBox {
            spacing: 0px;
            padding: 0px;

            // Log Viewer
            Log {
                width: 60%;
                logs: [];
            }

            SingleSeparatorH {
                separator-color: gray;
            }

            // Status Viewer
            Status {
                elems: [];
            }
        }
    }

    // Controller
    FloatingButton {
        x: 15px;
        y: ((root.height * 85%) - self.height) / 2;
        z: 2;

        enabled: stat != 0;
        size: 30px;
        text: "＜";

        clicked => {
            if (stat == 0) { stat  = 0; return; }
            if (stat == 5) { stat  = 2; return; }
            else           { stat -= 1; return; }
        }
    }

    FloatingButton {
        x: root.width - self.width - 15px;
        y: ((root.height * 85%) - self.height) / 2;
        z: 2;

        enabled: stat != 6;
        size: 30px;
        text: "＞";

        clicked => {
            if (stat == 2) { stat  = 5; return; }
            if (stat == 6) { stat  = 6; return; }
            else           { stat += 1; return; }
        }
    }
}
